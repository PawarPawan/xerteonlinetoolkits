<script type="text/javascript">
	
	// pageChanged & sizeChanged functions are needed in every model file
	// other functions for model should also be in here to avoid conflicts
	var mcq = new function() {
		// function called every time the page is viewed after it has initially loaded
		this.pageChanged = function() {
			$("#feedback").html("");
			$("#optionHolder input:checked").prop("checked", false);
			$("#checkBtn").attr("disabled", "disabled");
		}
		
		// function called every time the size of the LO is changed
		this.sizeChanged = function() {
			if (x_browserInfo.mobile == false) {
				var $panel = $("#pageContents .panel");
				$panel.height($x_pageHolder.height() - parseInt($x_pageDiv.css("padding-top")) * 2 - parseInt($panel.css("padding-top")) * 2 - 5);
			}
		}
		
		this.init = function() {
			// correct attribute on option also not used as it doesn't mark correct/incorrect - only gives feedback for each answer
			var panelWidth = x_currentPageXML.getAttribute("panelWidth");
			var $splitScreen = $("#pageContents .splitScreen");
			var $textHolder = $("#textHolder");
			if (panelWidth == "Full") {
				$("#pageContents .panel").appendTo($("#pageContents"));
				$splitScreen.remove();
			} else {
				$textHolder.html(x_addLineBreaks(x_currentPageXML.getAttribute("instruction")));
				var textAlign = x_currentPageXML.getAttribute("align");
				if (textAlign != "Right") {
					if (panelWidth == "Small") {
						$splitScreen.addClass("large");
					} else if (panelWidth == "Large") {
						$splitScreen.addClass("small");
					} else {
						$splitScreen.addClass("medium");
					}
				} else {
					$textHolder
						.removeClass("left")
						.addClass("right")
						.appendTo($splitScreen);
					$("#infoHolder")
						.removeClass("right")
						.addClass("left");
					if (panelWidth == "Small") {
						$splitScreen.addClass("medium");
					} else if (panelWidth == "Large") {
						$splitScreen.addClass("xlarge");
					} else {
						$splitScreen.addClass("large");
					}
				}
			}
			
			$("#question").html(x_addLineBreaks(x_currentPageXML.getAttribute("prompt")));
			
			var $optionHolder = $("#optionHolder");
			if (x_currentPageXML.getAttribute("type") == "Multiple Answer") {
				$optionHolder.find("input[type='radio']").remove();
			} else {
				$optionHolder.find("input[type='checkbox']").remove();
			}
			var $option = $optionHolder.find("input");
			var $optionTxt = $optionHolder.find(".optionTxt");
			$(x_currentPageXML).children()
				.each(function(i) {
					var $thisOption, $thisOptionTxt;
					if (i != 0) {
						$thisOption = $option.clone().appendTo($optionHolder);
						$thisOptionTxt = $optionTxt.clone().appendTo($optionHolder);
					} else {
						$thisOption = $option;
						$thisOptionTxt = $optionTxt;
					}
					
					$thisOption
						.attr({
							"value"	:this.getAttribute("text"),
							"id"	:"option" + i
							})
						.change(function() {
							$("#feedback").html("");
							var $checkBtn = $("#checkBtn");
							var $selected = $("#optionHolder input:checked");
							if ($checkBtn.attr("disabled") != "disabled" && $selected.length == 0) {
								$checkBtn.attr("disabled", "disabled");
							} else if ($checkBtn.attr("disabled") == "disabled" && $selected.length > 0) {
								$checkBtn.removeAttr("disabled");
							}
						});
					
					$thisOptionTxt
						.attr("for", "option" + i)
						.data("option", $thisOption)
						.html(this.getAttribute("text"));
				});
			
			// checkBtnWidth attribute not used as button will be sized automatically
			// if language attributes aren't in xml will have to use english fall back
			var checkBtnTxt = x_currentPageXML.getAttribute("checkBtnTxt");
			if (checkBtnTxt == undefined) {
				checkBtnTxt = "Check";
			}
			var checkBtnTip = x_currentPageXML.getAttribute("checkBtnTip");
			if (checkBtnTip == undefined) {
				checkBtnTip = "Check Answer";
			}
			$("#checkBtn")
				.button({
					label:			checkBtnTxt,
					description:	checkBtnTip
					})
				.attr("disabled", "disabled")
				.click(function() {
					var answerFeedback = "";
					var selected = $("#optionHolder input:checked");
					for (var i=0; i<selected.length; i++) {
						answerFeedback += "<p>" + x_addLineBreaks($(x_currentPageXML).children()[$(selected[i]).index()/2].getAttribute("feedback")) + "</p>";
					}
					var generalFeedback = "";
					if (x_currentPageXML.getAttribute("feedback") != undefined) {
						generalFeedback = "<p>" + x_addLineBreaks(x_currentPageXML.getAttribute("feedback")) + "</p>";
					}
					var feedbackLabel = x_currentPageXML.getAttribute("feedbackLabel");
					if (feedbackLabel == undefined) {
						feedbackLabel = "Feedback";
					}
					$("#feedback").html("<h3>" + feedbackLabel + "</h3>" + answerFeedback + generalFeedback);
				});
			
			if (x_currentPage != 0) {
				mcq.sizeChanged();
			}
			
			x_pageLoaded();
		}
	}
	
	mcq.init();
	
</script>

<style type="text/css">
	
	#pageContents .panel {
		overflow:	auto;
	}
	
	#optionHolder {
		margin-top:	15px;
	}
	
	#pageContents input {
		float:		left;
		display:	block;
	}
	
	#pageContents .optionTxt {
		cursor:			pointer;
		position:		relative;
		margin-left:	30px;
		margin-bottom:	10px;
		display:		block;
	}
	
	#pageContents button {
		margin:		10px;
		float:		right;
	}
	
	#pageContents #feedback {
		clear:		both;
	}
	
</style>

<div id="pageContents">
	
	<div class="splitScreen">
		
		<div id="textHolder" class="left"></div>
		
		<div id="infoHolder" class="right">
			<div class="panel">
				<h3 id="question"></h3>
				<div id="optionHolder">
					<input type="radio" name="option" />
					<input type="checkbox" name="option" />
					<label class="optionTxt"></label>
				</div>
				<button id="checkBtn"></button>
				<div id="feedback"></div>
			</div>
		</div>
		
	</div>
	
</div>