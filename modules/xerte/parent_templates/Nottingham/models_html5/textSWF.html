<script type="text/javascript">
	
	// pageChanged & sizeChanged functions are needed in every model file
	// other functions for model should also be in here to avoid conflicts
	var textSWF = new function() {		
		// function called every time the page is viewed after it has initially loaded
		this.pageChanged = function() {
			var $playBtn = $("#playBtn");
			if ($playBtn.length > 0 && $playBtn.data("state") == "pause") {
				$playBtn
					.data("state", "play")
					.button({
						icons: {
							primary: "ui-icon-play"
						},
						label:			$playBtn.data("play"),
						description:	$playBtn.data("play")
					});
			}
		}
		
		// function called every time the size of the LO is changed
		this.sizeChanged = function() {
			
		}
	}
	
	var $textHolder	= $("#textHolder");
	var $panel		= $("#pageContents .panel");
	
	// text align
	var textAlign = x_currentPageXML.getAttribute("align"); // Left|Right
	if (textAlign != "Right") {
		$panel.addClass("x_floatRight");
	} else if (textAlign == "Right") {
		$panel.addClass("x_floatLeft");
	}
	$textHolder.html(x_addLineBreaks(x_currentPageXML.childNodes[0].nodeValue));
	
	var size = ["100%","100%"];
	if (x_currentPageXML.getAttribute("movieSize") != "" && x_currentPageXML.getAttribute("movieSize") != undefined) {
		var dimensions = x_currentPageXML.getAttribute("movieSize").split(",");
		if (Number(dimensions[0]) != 0 && Number(dimensions[1]) != 0) {
			size = [Number(dimensions[0]), Number(dimensions[1])];
		}
	} else {
		// ** need to know original swf dimensions **
	}
	
	swfobject.embedSWF(eval(x_currentPageXML.getAttribute("url")), "pageSWF", size[0], size[1], "9.0.0", x_templateLocation + "common_html5/expressInstall.swf", "", "", "", function(e) {
		/*if (e.success == true) {
			var swf = e.ref;
			swf.init("Function called from page"); // ** this is not working to call the function in swf - possibly to do with swfObject **
		}*/
	});
	
	$("#pageSWF h3").html(x_getLangInfo(x_languageData.find("errorFlash")[0], "label", "You need to install the Flash Player to view this content."));
	$("#flashImg").attr("alt", x_getLangInfo(x_languageData.find("errorFlash")[0], "description", "Get the Flash Player"));
	
	$("#pageSWF").attr("title", x_currentPageXML.getAttribute("tip"));
	
	if (x_currentPageXML.getAttribute("controls") == "Control Bar" && x_browserInfo.iOS != true) {
		var $controls = $('<button id="playBtn"></button>');
		$controls
			.data({
				"state"	:"play",
				"play"	:x_getLangInfo(x_languageData.find("movieController").find("playButton")[0], "label", "Play Button"),
				"pause"	:x_getLangInfo(x_languageData.find("movieController").find("pauseButton")[0], "label", "Pause Button")
				})
			.button({
				icons: {
					primary: "ui-icon-play"
				},
				label:			$controls.data("play"),
				description:	$controls.data("play"),
				text:			false
				})
			.bind("click", function() {
				var flashMovie;
				if (window.document["pageSWF"]) {
					flashMovie = window.document["pageSWF"];
				}
				if (navigator.appName.indexOf("Microsoft Internet") == -1) {
					if (document.embeds && document.embeds["pageSWF"]) {
						flashMovie = document.embeds["pageSWF"];
					}
				} else {
					flashMovie = document.getElementById("pageSWF");
				}
				var $this = $(this);
				if ($this.data("state") == "play") {
					flashMovie.Play();
					$this.data("state", "pause");
				} else {
					flashMovie.StopPlay();
					$this.data("state", "play");
				}
				var state = $this.data("state");
				$this.button({
					icons: {
						primary: "ui-icon-" + state
					},
					label:			$this.data(state),
					description:	$this.data(state)
					})
				})
			.load(function() {
				})
		$panel.append($controls);
	}
	
	// call this function in every model once everything's loaded
	x_pageLoaded();
	
</script>

<style type="text/css">

	#playBtn {
		display:	block;
		width:		20px;
		height:		20px;
	}
	
</style>

<div id="pageContents">
	
	<div id="swfHolder" class="mobileAlign">
		<div class="panel inline">
			<div id="pageSWF">
				<h3></h3>
				<p><a href="http://www.adobe.com/go/getflashplayer"><img id="flashImg" src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif"/></a></p>
			</div>
		</div>
	</div>
	
	<div id="textHolder">
	
	</div>
	
</div>